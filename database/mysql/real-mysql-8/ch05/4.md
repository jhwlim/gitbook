---
description: Real MySQL 8.0
---

# 4. MySQL의 격리 수준

**트랜잭션의 격리 수준**

여러 트랜잭션이 동시에 처리될 때 특정 트랜잭션이 다른 트랜잭션에서 변경하거나 조회하는 데이터를 변경하거나 조회하는 데이터를 볼 수 있게 허용할지 말지를 결정하는 것

|     격리수준     | DIRTY READ | NON_REPEATABLE READ |     PHANTOM READ     |
| :--------------: | :--------: | :-----------------: | :------------------: |
| READ UNCOMMITTED |     O      |          O          |          O           |
|  READ COMMITTED  |     X      |          O          |          O           |
| REPEATABLE READ  |     X      |          X          | O<br>(InnoDB는 없음) |
|   SERIALIZABLE   |     X      |          X          |          X           |

SERIALIZABLE 격리 수준이 아니라면 크게 성능의 개선이나 저하는 발생하지 않는다.

## 1. READ UNCOMMITTED

각 트랜잭션에서의 변경 내용이 COMMIT 이나 ROLLBACK 여부에 상관없이 다른 트랜잭션에서 보인다.

### 더티 리드 (Dirty read)

어떤 트랜잭션에서 처리한 작업이 완료되지 않았는데도 다른 트랜잭션에서 볼 수 있는 현상

데이터가 나타났다가 사라졌다 하는 현상을 초래하므로 애플리케이션 개발자와 사용자를 상당히 혼란스럽게 만든다.

## 2. READ COMMITTED

오라클 DBMS에서 기본으로 사용되는 격리 수준

온라인 서비스에서 가장 많이 선택되는 격리 수준

더티 리드 같은 현상 발생 X

어떤 트랜잭션에서 데이터를 변경했더라도 COMMIT이 완료된 데이터만 다른 트랜잭션에서 조회할 수 있다.

### NON-REPEATABLE READ 부정합

하나의 트랜잭션 내에서 똑같은 SELECT 쿼리를 실행했을 때 다른 결과를 조회

금전적인 처리와 연결되면 문제가 될 수도 있다.

## 3. REPEATABLE READ

MySQL의 InnoDB 스토리지 엔진에서 기본으로 사용되는 격리 수준

바이너리 로그를 가진 MySQL 서버에서는 최소 REPEATABLE READ 격리 수준 이상을 사용해야 한다.

NON-REPEATABLE READ 부정합 발생 X

언두 영역에 백업된 이전 데이터를 이용해 동일 트랜잭션 내에서는 동일한 결과를 보여줄 수 있게 보장한다.

### vs. REPEATABLE COMMITTED

언두 영역에 백업된 레코드의 여러 버전 가운데 몇 번째 이전 버전까지 찾아 들어가야 하느냐에 차이가 있다.

REPEATABLE READ 격리 수준에서는 MVCC를 보장하기 위해 실행 중인 트랜잭션 가운데 가장 오래된 트랜잭션 번호보다 트랜잭션 번호가 앞선 언두 영역의 데이터는 삭제할 수 없다. (특정 트랜잭션 번호의 구간 내에서 백업된 언두 데이터가 보존돼야 한다.)

### PHANTOM READ (PHANTOM ROW)

다른 트랜잭션에서 수행한 변경 작업에 의해 레코드가 보였다 안 보였다 하는 현상

`SELECT ... FOR UPDATE` 쿼리는 SELECT 하는 레코드에 쓰기 잠금을 걸어야 하는데, 언두 레코드에는 잠금을 걸 수 없다. 그래서 `SELECT ... FOR UPDATE`나 `SELECT ... LOCK IN SHARE MODE`로 조회되는 레코드는 언두 영역의 변경 전 데이터를 가져오는 것이 아니라 현재 레코드의 값을 가져오게 된다.

**InnoDB 스토리지 엔진에서는 갭 락과 넥스트 키 락 덕분에 REPEATABLE READ 격리 수준에서도 해당 문제가 발생하지 않는다.**

## 4. SERIALIZABLE

가장 단순한 격리 수준이면서 동시에 가장 엄격한 격리 수준

동시 처리 성능도 다른 트랜잭션 격리 수준보다 떨어진다.

읽기 작업도 공유 잠금(읽기 잠금)을 획득해야만 하며, 동시에 다른 트랜잭션은 그러한 레코드를 변경하지 못하게 된다. 즉, 한 트랜잭션에서 읽고 쓰는 레코드를 다른 트랜잭션에서는 절대 접근할 수 없다.

PHANTOM READ 문제 발생 X
