---
description: Real MySQL 8.0
---

# 3. 테이블 암호화

키링 플러그인은 마스터 키를 생성하고 관리하는 부분까지만 담당하기 때문에, 어떤 키링 플러그인을 사용하든 관계없이 암호화된 테이블을 생성하고 활용하는 방법은 모두 동일하다.

## 1. 테이블 생성

데이터가 디스크에 기록될 때는 데이터가 자동으로 암호화되어 자장되고, 다시 디스크에서 메모리로 읽어올 때 복호화된다.

```sql
CREATE TABLE tab_encrypted (
    id INT,
    data VARCHAR(100),
    PRIMARY KEY(id)
) ENCRYPTION='Y';
```

`default_table_encryption` 시스템 변수를 ON으로 설정하면 ENCRYPTION 옵션을 별도로 설정하지 않고, MySQL 서버의 모든 테이블에 대해 암호화를 적용할 수 있다.

## 2. 응용 프로그램 암호화와의 비교

응용 프로그램에서 암호화된 컬럼은 인덱스를 생성하더라도 인덱스의 기능을 100% 활용할 수 없다.

MySQL 서버는 이미 암호화된 값을 기준으로 정렬하기 때문에 암호화되기 전의 값을 기준으로 정렬할 수 없다.

하지만 응용 프로그램에서 직접 암호화하지 않고, MySQL 서버의 암호화 기능(TDE)을 사용한다면 MySQL 서버는 인덱스 관련된 작업을 모두 처리한 후 최종 디스크에 데이터 페이지를 저장할 때만 암호화하기 때문에 이 같은 제약이 없다. (실행 중인 MySQL 서버에 로그인만 할 수 있다면 모든 데이터를 평문으로 확인할 수 있다.)

{% hint style="success" %}

응용 프로그램의 암호화와 MySQL 서버의 암호화 기능 중 선택해야 하는 상황이라면 MySQL 서버의 암호화 기능을 선택할 것을 권장한다.

{% endhint %}

## 3. 테이블스페이스 이동

테이블을 다른 서버로 복사해야 하는 경우 또는 특정 테이블의 데이터 파일만 백업했다가 복구하는 경우라면 테이블 스페이스 이동 (Expory & Import) 기능이 레코드를 덤프했다가 복구하는 방식보다 훨씬 효율적이고 빠르다.

```sql
FLUSH TABLE source_table FOR EXPORT;
```